<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Ultra Spotify Visualizer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <link rel="stylesheet" href="./styles.css" />
    <meta name="color-scheme" content="dark light" />
  </head>
  <body>
    <canvas id="visualizer"></canvas>

    <main id="app">
      <header>
        <h1>Ultra Spotify Visualizer</h1>
        <div id="actions">
          <button id="settings-btn" class="ghost" aria-label="Open settings" title="Settings">‚öôÔ∏è</button>
          <div id="auth">
            <button id="login-btn" class="primary">Log in with Spotify</button>
            <button id="logout-btn" class="ghost" hidden>Log out</button>
          </div>
        </div>
      </header>

      <section id="user" hidden>
        <img id="user-avatar" alt="" />
        <div>
          <div id="user-name"></div>
          <div id="user-product" class="badge"></div>
        </div>
      </section>

      <section id="player" hidden>
        <div id="track">
          <img id="album-art" alt="Album Art" />
          <div class="meta">
            <div id="track-name" class="title">‚Äî</div>
            <div id="track-artist" class="subtitle">‚Äî</div>
            <div id="track-album" class="subtitle muted">‚Äî</div>
          </div>
        </div>

        <div id="controls">
          <button id="prev" title="Previous">‚èÆ</button>
          <button id="play" title="Play/Pause">‚èØ</button>
          <button id="next" title="Next">‚è≠</button>
          <div id="time">
            <span id="elapsed">0:00</span>
            <input type="range" id="seek" min="0" max="1000" value="0" />
            <span id="duration">0:00</span>
          </div>
          <div id="volume">
            üîä
            <input type="range" id="volume-slider" min="0" max="100" value="50" />
          </div>
        </div>

        <div id="status" class="muted"></div>
      </section>

      <footer>
        <p class="muted small">
          Spotify Premium is required for in-browser playback using the Web Playback SDK. Visuals adapt to album colors and track tempo/energy.
        </p>
      </footer>
    </main>

    <!-- Overlay and slide-out drawer -->
    <div id="overlay" aria-hidden="true"></div>
    <aside id="drawer" aria-hidden="true" aria-label="Settings panel">
      <header class="drawer-header">
        <h2>Settings</h2>
        <button id="drawer-close" class="ghost" aria-label="Close settings">‚úñ</button>
      </header>

      <section class="drawer-section">
        <h3>Theme & Color</h3>
        <div class="field">
          <label for="theme">Theme</label>
          <select id="theme">
            <option value="album">Album Adaptive</option>
            <option value="neon">Neon</option>
            <option value="midnight">Midnight</option>
            <option value="sunset">Sunset</option>
            <option value="ocean">Ocean</option>
            <option value="vaporwave">Vaporwave</option>
            <option value="cyber">Cyberpunk</option>
            <option value="candy">Candy</option>
            <option value="noir">Noir</option>
            <option value="mono">Mono (custom)</option>
          </select>
        </div>
        <div class="field" id="custom-color-field" hidden>
          <label for="custom-color">Custom color</label>
          <input type="color" id="custom-color" value="#1db954" />
        </div>
        <div class="field">
          <label class="checkbox">
            <input type="checkbox" id="lock-palette" />
            Lock album colors (don‚Äôt change per track)
          </label>
        </div>
      </section>

      <section class="drawer-section">
        <h3>Global Motion/Look</h3>
        <div class="field">
          <label for="complexity">Complexity <span data-out="complexity-val"></span></label>
          <input type="range" id="complexity" min="0.3" max="2" step="0.1" />
        </div>
        <div class="field">
          <label for="rotation">Rotation speed <span data-out="rotation-val"></span></label>
          <input type="range" id="rotation" min="0.4" max="3" step="0.1" />
        </div>
        <div class="field">
          <label for="pulse">Pulse intensity <span data-out="pulse-val"></span></label>
          <input type="range" id="pulse" min="0" max="2" step="0.05" />
        </div>
        <div class="field">
          <label for="trail">Trail fade <span data-out="trail-val"></span></label>
          <input type="range" id="trail" min="0" max="0.3" step="0.01" />
        </div>
        <div class="field">
          <label for="glow">Background glow <span data-out="glow-val"></span></label>
          <input type="range" id="glow" min="0" max="0.6" step="0.02" />
        </div>
        <div class="field">
          <label for="bloom">Bloom strength <span data-out="bloom-val"></span></label>
          <input type="range" id="bloom" min="0" max="1" step="0.05" />
        </div>
      </section>

      <section class="drawer-section">
        <h3>Scene Stack</h3>
        <div class="grid2">
          <label class="checkbox"><input type="checkbox" id="layer-rings" checked /> Rings</label>
          <label class="checkbox"><input type="checkbox" id="layer-particles" checked /> Flow Field</label>
          <label class="checkbox"><input type="checkbox" id="layer-orbit" /> Orbit Lines</label>
          <label class="checkbox"><input type="checkbox" id="layer-tunnel" checked /> Tunnel</label>
          <label class="checkbox"><input type="checkbox" id="layer-ripples" /> Ripples/Voronoi</label>
          <label class="checkbox"><input type="checkbox" id="layer-ribbons" /> Ribbons</label>
          <label class="checkbox"><input type="checkbox" id="layer-kaleido" /> Kaleidoscope</label>
          <label class="checkbox"><input type="checkbox" id="layer-covers" checked /> Floating Covers</label>
        </div>
      </section>

      <section class="drawer-section">
        <h3>Post FX</h3>
        <div class="grid2">
          <label class="checkbox"><input type="checkbox" id="fx-vignette" checked /> Vignette</label>
          <label class="checkbox"><input type="checkbox" id="fx-grain" checked /> Grain</label>
          <label class="checkbox"><input type="checkbox" id="fx-chroma" /> Chromatic Aberration</label>
          <label class="checkbox"><input type="checkbox" id="fx-bloom" checked /> Bloom-ish</label>
          <label class="checkbox"><input type="checkbox" id="fx-dof" /> Depth of Field</label>
        </div>
      </section>

      <section class="drawer-section">
        <h3>Camera</h3>
        <div class="field">
          <label for="cam-mode">Mode</label>
          <select id="cam-mode">
            <option value="none">None</option>
            <option value="orbit">Orbit</option>
            <option value="dolly">Dolly</option>
          </select>
        </div>
        <div class="field">
          <label for="cam-shake">Shake <span data-out="shake-val"></span></label>
          <input type="range" id="cam-shake" min="0" max="10" step="0.5" />
        </div>
        <div class="field">
          <label class="checkbox"><input type="checkbox" id="cam-gyro" /> Tilt with device</label>
        </div>
      </section>

      <section class="drawer-section">
        <h3>Analysis & Timeline</h3>
        <div class="grid2">
          <label class="checkbox"><input type="checkbox" id="map-analysis" checked /> Use beats/bars/sections</label>
          <label class="checkbox"><input type="checkbox" id="enable-keyframes" /> Keyframe demo</label>
        </div>
      </section>

      <section class="drawer-section">
        <h3>Visualizer Presets</h3>
        <div class="row">
          <button class="chip" data-preset="classic-rings">Classic Rings</button>
          <button class="chip" data-preset="aurora-particles">Aurora Particles</button>
          <button class="chip" data-preset="cyber-lines">Cyber Neon Lines</button>
          <button class="chip" data-preset="sunset-tunnel">Sunset Tunnel</button>
          <button class="chip" data-preset="vapor-float">Vaporwave Float</button>
          <button class="chip" data-preset="minimal-noir">Minimal Noir</button>
        </div>
      </section>

      <section class="drawer-section">
        <h3>Theme Presets</h3>
        <div class="row">
          <button class="chip" data-theme="album">Album</button>
          <button class="chip" data-theme="neon">Neon</button>
          <button class="chip" data-theme="midnight">Midnight</button>
          <button class="chip" data-theme="sunset">Sunset</button>
          <button class="chip" data-theme="ocean">Ocean</button>
          <button class="chip" data-theme="vaporwave">Vaporwave</button>
          <button class="chip" data-theme="cyber">Cyber</button>
          <button class="chip" data-theme="candy">Candy</button>
          <button class="chip" data-theme="noir">Noir</button>
        </div>
      </section>
    </aside>

    <!-- Global config (non-module) -->
    <script src="./config.js"></script>
    <!-- Spotify Web Playback SDK -->
    <script async src="https://sdk.scdn.co/spotify-player.js"></script>
    <!-- App (module) -->
    <script type="module" src="./app.js"></script>
  </body>
</html>